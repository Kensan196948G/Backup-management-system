# 国際化・ローカライズ仕様書（i18n / L10n）

**プロジェクト名:** バックアップ管理システム WebUI
**バージョン:** 1.0.0
**作成日:** 2026-02-25

---

## 1. 対応言語

| 言語 | ロケール | ステータス |
|------|---------|----------|
| 日本語 | `ja-JP` | 必須（デフォルト） |
| 英語（米国） | `en-US` | 必須 |

---

## 2. 技術スタック

| 用途 | ライブラリ | バージョン |
|------|----------|----------|
| フロントエンド i18n | react-i18next | 14.x |
| バックエンド i18n | Babel（Python） | - |
| 翻訳ファイル形式 | JSON | - |
| 日時フォーマット | date-fns / Intl API | - |
| 数値フォーマット | Intl.NumberFormat | - |

---

## 3. 翻訳ファイル構成

```
src/
└── locales/
    ├── ja/
    │   ├── common.json        # 共通テキスト
    │   ├── auth.json          # 認証関連
    │   ├── dashboard.json     # ダッシュボード
    │   ├── jobs.json          # ジョブ管理
    │   ├── reports.json       # レポート
    │   ├── settings.json      # 設定
    │   └── errors.json        # エラーメッセージ
    └── en/
        ├── common.json
        ├── auth.json
        ├── dashboard.json
        ├── jobs.json
        ├── reports.json
        ├── settings.json
        └── errors.json
```

---

## 4. 翻訳キー規則

**命名規則:** `{画面/機能}.{コンテキスト}.{要素}`

**サンプル（common.json）:**
```json
{
  "common": {
    "buttons": {
      "save": "保存",
      "cancel": "キャンセル",
      "delete": "削除",
      "edit": "編集",
      "create": "新規作成",
      "back": "戻る",
      "next": "次へ",
      "confirm": "確認",
      "download": "ダウンロード"
    },
    "status": {
      "success": "成功",
      "error": "失敗",
      "running": "実行中",
      "pending": "待機中",
      "disabled": "無効",
      "warning": "警告"
    },
    "pagination": {
      "showing": "{{total}}件中 {{from}}-{{to}}件を表示",
      "per_page": "{{count}}件/ページ"
    }
  }
}
```

**複数形への対応:**
```json
{
  "jobs": {
    "count_zero": "ジョブはありません",
    "count_one": "{{count}}件のジョブ",
    "count_other": "{{count}}件のジョブ"
  }
}
```

```typescript
// 使用例
t('jobs.count', { count: 5 }) // → "5件のジョブ"
```

---

## 5. 日時フォーマット

### 5.1 ロケール別フォーマット

| 用途 | ja-JP | en-US |
|------|-------|-------|
| 日付 | 2026年2月25日 | February 25, 2026 |
| 日付（短縮） | 2026/02/25 | 02/25/2026 |
| 時刻 | 09:00:00 | 9:00:00 AM |
| 日時 | 2026年2月25日 09:00 | Feb 25, 2026, 9:00 AM |
| 相対時間 | 3分前 / 2時間前 | 3 minutes ago |

**実装:**
```typescript
// Intl API を使用
const formatDate = (date: Date, locale: string) =>
  new Intl.DateTimeFormat(locale, {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
  }).format(date);
```

### 5.2 タイムゾーン

- UI 表示: ブラウザのローカルタイムゾーン（`Intl.DateTimeFormat().resolvedOptions().timeZone`）
- API 送受信: UTC（ISO 8601 形式: `2026-02-25T09:00:00Z`）
- ユーザー設定: プロフィール設定でタイムゾーンを変更可能

---

## 6. 数値フォーマット

| 用途 | ja-JP | en-US |
|------|-------|-------|
| 数値 | 1,234,567 | 1,234,567 |
| パーセント | 68.5% | 68.5% |
| ファイルサイズ | 10.5 GB | 10.5 GB |

**ファイルサイズ変換:**
```typescript
const formatBytes = (bytes: number, locale: string): string => {
  const units = ['B', 'KB', 'MB', 'GB', 'TB'];
  let value = bytes;
  let unitIndex = 0;
  while (value >= 1024 && unitIndex < units.length - 1) {
    value /= 1024;
    unitIndex++;
  }
  return `${new Intl.NumberFormat(locale, {
    maximumFractionDigits: 1
  }).format(value)} ${units[unitIndex]}`;
};
```

---

## 7. 言語切り替え

### 7.1 言語検出優先順位

1. ユーザープロフィール設定
2. ブラウザの優先言語（`navigator.language`）
3. デフォルト（`ja-JP`）

### 7.2 UI での切り替え

- トップバー右側に言語切り替えドロップダウンを配置
- 切り替え時はページを再読み込みしない（SPA 内で即時反映）
- 選択言語は localStorage に保存

---

## 8. 翻訳作業フロー

1. 日本語でキーとメッセージを定義（基準言語）
2. 英語翻訳を作成
3. Pull Request レビュー時に翻訳漏れチェック（CI で自動検出）
4. 未翻訳キーはデフォルト言語（日本語）にフォールバック

**CI チェック（未翻訳キー検出）:**
```bash
# 翻訳漏れを検出するスクリプト
npx i18next-scanner --detect-missing-keys
```

---

## 更新履歴

| 日付 | バージョン | 更新者 | 内容 |
|------|-----------|--------|------|
| 2026-02-25 | 1.0.0 | システム管理者 | 初版作成 |
